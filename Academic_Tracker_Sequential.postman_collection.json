{
	"info": {
		"_postman_id": "academic-tracker-sequential",
		"name": "Academic Tracker - Sequential Testing",
		"description": "Complete sequential testing with proper role-based access control. Follow the order to avoid 403 errors.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Phase 1 - Register Users",
			"item": [
				{
					"name": "1. Register Admin",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Admin User\",\n    \"email\": \"admin@test.com\",\n    \"password\": \"admin123\",\n    \"role\": \"ADMIN\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					}
				},
				{
					"name": "2. Register Teacher",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"John Teacher\",\n    \"email\": \"teacher@test.com\",\n    \"password\": \"teacher123\",\n    \"role\": \"TEACHER\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					}
				},
				{
					"name": "3. Register Student",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Jane Student\",\n    \"email\": \"student@test.com\",\n    \"password\": \"student123\",\n    \"role\": \"STUDENT\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					}
				},
				{
					"name": "4. Register Parent",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Parent User\",\n    \"email\": \"parent@test.com\",\n    \"password\": \"parent123\",\n    \"role\": \"PARENT\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					}
				}
			]
		},
		{
			"name": "Phase 2 - Admin Login & Operations",
			"item": [
				{
					"name": "5. Login as Admin",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.token) {",
									"    pm.environment.set('adminToken', jsonData.token);",
									"    pm.environment.set('token', jsonData.token);",
									"}",
									"if (jsonData.id) {",
									"    pm.environment.set('adminId', jsonData.id);",
									"}",
									"console.log('✅ Admin logged in. Token saved.');"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"admin@test.com\",\n    \"password\": \"admin123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						}
					}
				},
				{
					"name": "6. Get All Users (Admin)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/all",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "all"]
						}
					}
				},
				{
					"name": "7. Get User by Email (Admin)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/email/student@test.com",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "email", "student@test.com"]
						}
					}
				}
			]
		},
		{
			"name": "Phase 3 - Teacher Login & Operations",
			"item": [
				{
					"name": "8. Login as Teacher",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.token) {",
									"    pm.environment.set('teacherToken', jsonData.token);",
									"    pm.environment.set('token', jsonData.token);",
									"}",
									"if (jsonData.id) {",
									"    pm.environment.set('teacherId', jsonData.id);",
									"}",
									"console.log('✅ Teacher logged in. ID: ' + jsonData.id);"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"teacher@test.com\",\n    \"password\": \"teacher123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						}
					}
				},
				{
					"name": "9. Add Course - Mathematics (Teacher)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.id) {",
									"    pm.environment.set('courseId', jsonData.id);",
									"}",
									"console.log('✅ Course created. ID: ' + jsonData.id);"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Mathematics\",\n    \"section\": \"A\",\n    \"teacher\": {\n        \"id\": {{teacherId}}\n    }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/courses/add",
							"host": ["{{baseUrl}}"],
							"path": ["api", "courses", "add"]
						}
					}
				},
				{
					"name": "10. Add Course - Physics (Teacher)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Physics\",\n    \"section\": \"B\",\n    \"teacher\": {\n        \"id\": {{teacherId}}\n    }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/courses/add",
							"host": ["{{baseUrl}}"],
							"path": ["api", "courses", "add"]
						}
					}
				},
				{
					"name": "11. Get All Courses (Teacher)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/courses/all",
							"host": ["{{baseUrl}}"],
							"path": ["api", "courses", "all"]
						}
					}
				}
			]
		},
		{
			"name": "Phase 4 - Student Login",
			"item": [
				{
					"name": "12. Login as Student",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.token) {",
									"    pm.environment.set('studentToken', jsonData.token);",
									"    pm.environment.set('token', jsonData.token);",
									"}",
									"if (jsonData.id) {",
									"    pm.environment.set('studentId', jsonData.id);",
									"}",
									"console.log('✅ Student logged in. ID: ' + jsonData.id);"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"student@test.com\",\n    \"password\": \"student123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						}
					}
				},
				{
					"name": "13. Get All Courses (Student)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{studentToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/courses/all",
							"host": ["{{baseUrl}}"],
							"path": ["api", "courses", "all"]
						}
					}
				}
			]
		},
		{
			"name": "Phase 5 - Teacher Data Entry",
			"item": [
				{
					"name": "14. Mark Attendance - Present",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"studentId\": {{studentId}},\n    \"courseId\": {{courseId}},\n    \"date\": \"2025-10-08\",\n    \"present\": true,\n    \"remarks\": \"On time\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/attendance/mark",
							"host": ["{{baseUrl}}"],
							"path": ["api", "attendance", "mark"]
						}
					}
				},
				{
					"name": "15. Mark Attendance - Absent",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"studentId\": {{studentId}},\n    \"courseId\": {{courseId}},\n    \"date\": \"2025-10-07\",\n    \"present\": false,\n    \"remarks\": \"Sick leave\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/attendance/mark",
							"host": ["{{baseUrl}}"],
							"path": ["api", "attendance", "mark"]
						}
					}
				},
				{
					"name": "16. Mark Attendance - Another Day",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"studentId\": {{studentId}},\n    \"courseId\": {{courseId}},\n    \"date\": \"2025-10-06\",\n    \"present\": true,\n    \"remarks\": \"Participated well\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/attendance/mark",
							"host": ["{{baseUrl}}"],
							"path": ["api", "attendance", "mark"]
						}
					}
				},
				{
					"name": "17. Add Marks",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"student\": {\n        \"id\": {{studentId}}\n    },\n    \"course\": {\n        \"id\": {{courseId}}\n    },\n    \"score\": 85.5\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/marks/add",
							"host": ["{{baseUrl}}"],
							"path": ["api", "marks", "add"]
						}
					}
				},
				{
					"name": "18. Get Attendance by Course",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/attendance/course/{{courseId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "attendance", "course", "{{courseId}}"]
						}
					}
				},
				{
					"name": "19. Get Marks by Course",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/marks/course/{{courseId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "marks", "course", "{{courseId}}"]
						}
					}
				},
				{
					"name": "20. Get Attendance by Date",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{teacherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/attendance/date/2025-10-08",
							"host": ["{{baseUrl}}"],
							"path": ["api", "attendance", "date", "2025-10-08"]
						}
					}
				}
			]
		},
		{
			"name": "Phase 6 - Student Views Data",
			"item": [
				{
					"name": "21. Get Own Attendance (Student)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{studentToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/attendance/student/{{studentId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "attendance", "student", "{{studentId}}"]
						}
					}
				},
				{
					"name": "22. Get Own Marks (Student)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{studentToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/marks/student/{{studentId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "marks", "student", "{{studentId}}"]
						}
					}
				},
				{
					"name": "23. Get Own Profile (Student)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{studentToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/{{studentId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "{{studentId}}"]
						}
					}
				}
			]
		},
		{
			"name": "Phase 7 - Parent Login & View",
			"item": [
				{
					"name": "24. Login as Parent",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.token) {",
									"    pm.environment.set('parentToken', jsonData.token);",
									"    pm.environment.set('token', jsonData.token);",
									"}",
									"if (jsonData.id) {",
									"    pm.environment.set('parentId', jsonData.id);",
									"}",
									"console.log('✅ Parent logged in.');"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"parent@test.com\",\n    \"password\": \"parent123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						}
					}
				},
				{
					"name": "25. Get Student Attendance (Parent)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{parentToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/attendance/student/{{studentId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "attendance", "student", "{{studentId}}"]
						}
					}
				},
				{
					"name": "26. Get Student Marks (Parent)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{parentToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/marks/student/{{studentId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "marks", "student", "{{studentId}}"]
						}
					}
				}
			]
		},
		{
			"name": "Phase 8 - Access Control Tests (Should Fail)",
			"item": [
				{
					"name": "27. Student tries Get All Users (403)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Access denied for Student', function () {",
									"    pm.response.to.have.status(403);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{studentToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/all",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "all"]
						}
					}
				},
				{
					"name": "28. Student tries Add Course (403)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Access denied for Student', function () {",
									"    pm.response.to.have.status(403);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{studentToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Chemistry\",\n    \"section\": \"C\",\n    \"teacher\": {\n        \"id\": {{teacherId}}\n    }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/courses/add",
							"host": ["{{baseUrl}}"],
							"path": ["api", "courses", "add"]
						}
					}
				},
				{
					"name": "29. Student tries Mark Attendance (403)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Access denied for Student', function () {",
									"    pm.response.to.have.status(403);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{studentToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"studentId\": {{studentId}},\n    \"courseId\": {{courseId}},\n    \"date\": \"2025-10-08\",\n    \"present\": true,\n    \"remarks\": \"Test\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/attendance/mark",
							"host": ["{{baseUrl}}"],
							"path": ["api", "attendance", "mark"]
						}
					}
				},
				{
					"name": "30. Student tries Add Marks (403)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Access denied for Student', function () {",
									"    pm.response.to.have.status(403);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{studentToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"student\": {\n        \"id\": {{studentId}}\n    },\n    \"course\": {\n        \"id\": {{courseId}}\n    },\n    \"score\": 95.0\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/marks/add",
							"host": ["{{baseUrl}}"],
							"path": ["api", "marks", "add"]
						}
					}
				},
				{
					"name": "31. Parent tries Add Course (403)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Access denied for Parent', function () {",
									"    pm.response.to.have.status(403);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{parentToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Biology\",\n    \"section\": \"D\",\n    \"teacher\": {\n        \"id\": {{teacherId}}\n    }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/courses/add",
							"host": ["{{baseUrl}}"],
							"path": ["api", "courses", "add"]
						}
					}
				},
				{
					"name": "32. No Token - Get Courses (401)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Unauthorized without token', function () {",
									"    pm.response.to.have.status(401);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/courses/all",
							"host": ["{{baseUrl}}"],
							"path": ["api", "courses", "all"]
						}
					}
				}
			]
		},
		{
			"name": "Phase 9 - Admin Cleanup",
			"item": [
				{
					"name": "33. Delete Course (Admin)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/courses/{{courseId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "courses", "{{courseId}}"]
						}
					}
				},
				{
					"name": "34. Delete User (Admin)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/{{studentId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "{{studentId}}"]
						}
					}
				},
				{
					"name": "35. Logout",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/auth/logout",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "logout"]
						}
					}
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080"
		}
	]
}
